<!doctype html>
<link rel="stylesheet" href="../../style.css">
<title>irccex :: 55d5438</title>
<h1><a href="../index.html" title="Back to Repository">&larr;&#xFE0E;</a> irccex :: 55d5438</h1>
<hr>
<table id="main" cellpadding="0" cellspacing="0">
<tr class="item"><td class="linenumber"><a href="#l1" name="l1">1</a></td><td><pre><span class="commit">commit 55d54389c46a8fbf76666a48f558fbea185e21e7</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l2" name="l2">2</a></td><td><pre>Author: acidvegas &lt;acid.vegas@acid.vegas&gt;</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l3" name="l3">3</a></td><td><pre>Date:   Sat Mar 21 03:14:11 2020 -0400</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l4" name="l4">4</a></td><td><pre></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l5" name="l5">5</a></td><td><pre>    Added double fees loop, removed all 3rd party library requirements, cleaned up</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l6" name="l6">6</a></td><td><pre>---</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l7" name="l7">7</a></td><td><pre> README.md                                |  3 <span class="insertion">++</span><span class="deletion">-</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l8" name="l8">8</a></td><td><pre> irccex/core/{cmc.py =&gt; coinmarketcap.py} | 29 <span class="insertion">++++++++++</span><span class="deletion">----------</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l9" name="l9">9</a></td><td><pre> irccex/core/config.py                    |  1 <span class="deletion">-</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l10" name="l10">10</a></td><td><pre> irccex/core/irc.py                       | 45 <span class="insertion">+++++++++++++++++++++++</span><span class="deletion">---------</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l11" name="l11">11</a></td><td><pre> irccex/data/cert/.gitignore              |  4 <span class="deletion">---</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l12" name="l12">12</a></td><td><pre> irccex/data/dbx.py                       | 12 <span class="deletion">---------</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l13" name="l13">13</a></td><td><pre> irccex/data/logs/.gitignore              |  4 <span class="deletion">---</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l14" name="l14">14</a></td><td><pre> 7 files changed, 48 insertions(+), 50 deletions(-)</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l15" name="l15">15</a></td><td><pre></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l16" name="l16">16</a></td><td><pre><span class="bold">diff --git a/README.md b/README.md</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l17" name="l17">17</a></td><td><pre><span class="bold">index 49e4cc3..788783c 100644</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l18" name="l18">18</a></td><td><pre><span class="bold">--- a/README.md</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l19" name="l19">19</a></td><td><pre><span class="bold">+++ b/README.md</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l20" name="l20">20</a></td><td><pre><span class="hunk">@@ -83,15 +83,16 @@</span> </span>Support the project development if you like it: [Patreon.com/irccex](https://pat</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l21" name="l21">21</a></td><td><pre> The IRCCEX project is completely open source &amp; non-profit, though any support/pledges will help in motivation towards more development and adding new features!</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l22" name="l22">22</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l23" name="l23">23</a></td><td><pre> ###### Future Concepts &amp; Ideas</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l24" name="l24">24</a></td><td><pre><span class="insertion">+</span><span class="insertion">* Use multiple API keys to prevent rate limiting.</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l25" name="l25">25</a></td><td><pre> * IRCCEX BlockChain - Keep an on-going ledger of every single transaction ever made in the channel. *(No idea what use it would have. Maybe a `!trades` command for recent history. The idea makes me laugh)*</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l26" name="l26">26</a></td><td><pre> * Buying options - Spend a large sum of money on features like locking someone from trading for X amount of time (Charge Y per hour and max it to 24 hours), wallet spying, wallet bombing (sending a bunch of shitcoins), hindsight where you get private message alerts on a coins price changing (can be used whenever only once).</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l27" name="l27">27</a></td><td><pre><span class="deletion">-* Double fees for 1-3 days randomly in round!</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l28" name="l28">28</a></td><td><pre> * Post reward pool bangs will make you lose money to fuck with people spamming hard with bots to rack up the pool</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l29" name="l29">29</a></td><td><pre> * Crate Drops - A &quot;crate&quot; will drop randomly in the channel that requires multiple `!break`'s to open it. Once opened, there will be 4 items you can get by typing the ! command under it. Items will include money, extra privlegges like holding more coins, and other items you can win.</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l30" name="l30">30</a></td><td><pre> * **Suicide Round** - There is no bank in this mode, and if you lose your nick through a NICK or QUIT, you lose your wallet. Round can last 3-7 days and the top 10 wallets will score.</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l31" name="l31">31</a></td><td><pre> * **Bank Round** - Round lasts a week and the top 10 players in the bank will score.</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l32" name="l32">32</a></td><td><pre> * **Flash Match** - Round lasts a day and the top 10 players in the bank will score.</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l33" name="l33">33</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l34" name="l34">34</a></td><td><pre><span class="insertion">+</span><span class="insertion">###### Try it out</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l35" name="l35">35</a></td><td><pre> We are running IRCCEX actively in **#exchange** on **EFNet** &amp; **SuperNETs**, come chat with us, make some money, and share ideas!</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l36" name="l36">36</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l37" name="l37">37</a></td><td><pre> ###### Mirrors</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l38" name="l38">38</a></td><td><pre><span class="bold">diff --git a/irccex/core/cmc.py b/irccex/core/coinmarketcap.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l39" name="l39">39</a></td><td><pre><span class="bold">similarity index 63%</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l40" name="l40">40</a></td><td><pre><span class="bold">rename from irccex/core/cmc.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l41" name="l41">41</a></td><td><pre><span class="bold">rename to irccex/core/coinmarketcap.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l42" name="l42">42</a></td><td><pre><span class="bold">index 7a2a2d9..3d2cfe3 100644</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l43" name="l43">43</a></td><td><pre><span class="bold">--- a/irccex/core/cmc.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l44" name="l44">44</a></td><td><pre><span class="bold">+++ b/irccex/core/coinmarketcap.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l45" name="l45">45</a></td><td><pre><span class="hunk">@@ -1,24 +1,23 @@</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l46" name="l46">46</a></td><td><pre> #!/usr/bin/env python</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l47" name="l47">47</a></td><td><pre><span class="deletion">-# IRC Cryptocurrency Exchange (IRCCEX) - Developed by acidvegas in Python (https://acid.vegas/irccex)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l48" name="l48">48</a></td><td><pre><span class="deletion">-# cmc.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l49" name="l49">49</a></td><td><pre><span class="insertion">+</span><span class="insertion"># CoinMarketCap API Class - Developed by acidvegas in Python (https://acid.vegas/coinmarketcap)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l50" name="l50">50</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l51" name="l51">51</a></td><td><pre><span class="insertion">+</span><span class="insertion">import http.client</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l52" name="l52">52</a></td><td><pre> import json</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l53" name="l53">53</a></td><td><pre> import time</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l54" name="l54">54</a></td><td><pre><span class="deletion">-</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l55" name="l55">55</a></td><td><pre><span class="deletion">-import requests</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l56" name="l56">56</a></td><td><pre><span class="deletion">-</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l57" name="l57">57</a></td><td><pre><span class="deletion">-import config</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l58" name="l58">58</a></td><td><pre><span class="insertion">+</span><span class="insertion">import zlib</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l59" name="l59">59</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l60" name="l60">60</a></td><td><pre> class CoinMarketCap(object):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l61" name="l61">61</a></td><td><pre><span class="deletion">-	def __init__(self):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l62" name="l62">62</a></td><td><pre><span class="deletion">-		self.cache = {'global':dict(), 'ticker':dict()}</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l63" name="l63">63</a></td><td><pre><span class="deletion">-		self.last  = {'global':0     , 'ticker':0     }</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l64" name="l64">64</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">def __init__(self, api_key):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l65" name="l65">65</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">self.api_key = api_key</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l66" name="l66">66</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">self.cache   = {'global':dict(), 'ticker':dict()}</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l67" name="l67">67</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">self.last    = {'global':0     , 'ticker':0     }</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l68" name="l68">68</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l69" name="l69">69</a></td><td><pre><span class="deletion">-	def _api(self, _endpoint, _params={}):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l70" name="l70">70</a></td><td><pre><span class="deletion">-		session = requests.Session()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l71" name="l71">71</a></td><td><pre><span class="deletion">-		session.headers.update({'Accept':'application/json', 'Accept-Encoding':'deflate, gzip', 'X-CMC_PRO_API_KEY':config.CMC_API_KEY})</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l72" name="l72">72</a></td><td><pre><span class="deletion">-		response = session.get('https://pro-api.coinmarketcap.com/v1/' + _endpoint, params=_params, timeout=15)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l73" name="l73">73</a></td><td><pre><span class="deletion">-		return json.loads(response.text.replace(': null', ': &quot;0&quot;'))['data']</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l74" name="l74">74</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">def _api(self, _endpoint):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l75" name="l75">75</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">conn = http.client.HTTPSConnection('pro-api.coinmarketcap.com', timeout=15)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l76" name="l76">76</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">conn.request('GET', '/v1/' + _endpoint, headers={'Accept':'application/json', 'Accept-Encoding':'deflate, gzip', 'X-CMC_PRO_API_KEY':self.api_key})</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l77" name="l77">77</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">response = zlib.decompress(conn.getresponse().read(), 16+zlib.MAX_WBITS).decode('utf-8').replace(': null', ': &quot;0&quot;')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l78" name="l78">78</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">conn.close()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l79" name="l79">79</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">return json.loads(response)['data']</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l80" name="l80">80</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l81" name="l81">81</a></td><td><pre> 	def _global(self):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l82" name="l82">82</a></td><td><pre> 		if time.time() - self.last['global'] &lt; 300:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l83" name="l83">83</a></td><td><pre><span class="hunk">@@ -40,7 +39,7 @@</span> </span>class CoinMarketCap(object):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l84" name="l84">84</a></td><td><pre> 		if time.time() - self.last['ticker'] &lt; 300:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l85" name="l85">85</a></td><td><pre> 			return self.cache['ticker']</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l86" name="l86">86</a></td><td><pre> 		else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l87" name="l87">87</a></td><td><pre><span class="deletion">-			data = self._api('cryptocurrency/listings/latest', {'limit':'5000'})</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l88" name="l88">88</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">data = self._api('cryptocurrency/listings/latest?limit=5000')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l89" name="l89">89</a></td><td><pre> 			self.cache['ticker'] = dict()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l90" name="l90">90</a></td><td><pre> 			for item in data:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l91" name="l91">91</a></td><td><pre> 				self.cache['ticker'][item['symbol']] = {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l92" name="l92">92</a></td><td><pre><span class="bold">diff --git a/irccex/core/config.py b/irccex/core/config.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l93" name="l93">93</a></td><td><pre><span class="bold">index 81e4b3c..f1c56e3 100644</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l94" name="l94">94</a></td><td><pre><span class="bold">--- a/irccex/core/config.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l95" name="l95">95</a></td><td><pre><span class="bold">+++ b/irccex/core/config.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l96" name="l96">96</a></td><td><pre><span class="hunk">@@ -15,7 +15,6 @@</span> </span>class connection:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l97" name="l97">97</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l98" name="l98">98</a></td><td><pre> class cert:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l99" name="l99">99</a></td><td><pre> 	key      = None</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l100" name="l100">100</a></td><td><pre><span class="deletion">-	file     = None</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l101" name="l101">101</a></td><td><pre> 	password = None</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l102" name="l102">102</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l103" name="l103">103</a></td><td><pre> class ident:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l104" name="l104">104</a></td><td><pre><span class="bold">diff --git a/irccex/core/irc.py b/irccex/core/irc.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l105" name="l105">105</a></td><td><pre><span class="bold">index 09d5ea8..c5b3491 100644</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l106" name="l106">106</a></td><td><pre><span class="bold">--- a/irccex/core/irc.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l107" name="l107">107</a></td><td><pre><span class="bold">+++ b/irccex/core/irc.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l108" name="l108">108</a></td><td><pre><span class="hunk">@@ -20,7 +20,7 @@</span> </span>import time</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l109" name="l109">109</a></td><td><pre> import config</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l110" name="l110">110</a></td><td><pre> import constants</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l111" name="l111">111</a></td><td><pre> import functions</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l112" name="l112">112</a></td><td><pre><span class="deletion">-from cmc import CoinMarketCap</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l113" name="l113">113</a></td><td><pre><span class="insertion">+</span><span class="insertion">from coinmarketcap import CoinMarketCap</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l114" name="l114">114</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l115" name="l115">115</a></td><td><pre> if config.connection.ssl:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l116" name="l116">116</a></td><td><pre> 	import ssl</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l117" name="l117">117</a></td><td><pre><span class="hunk">@@ -43,8 +43,8 @@</span> </span>class IRC(object):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l118" name="l118">118</a></td><td><pre> 		self.start       = time.time()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l119" name="l119">119</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l120" name="l120">120</a></td><td><pre> 	def run(self):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l121" name="l121">121</a></td><td><pre><span class="deletion">-		if os.path.isfile('data/db.pkl'):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l122" name="l122">122</a></td><td><pre><span class="deletion">-			with open('data/db.pkl', 'rb') as db_file:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l123" name="l123">123</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">if os.path.isfile('db.pkl'):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l124" name="l124">124</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">with open('db.pkl', 'rb') as db_file:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l125" name="l125">125</a></td><td><pre> 				self.db = pickle.load(db_file)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l126" name="l126">126</a></td><td><pre> 			print('[+] - Restored database!')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l127" name="l127">127</a></td><td><pre> 		Loops.start_loops()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l128" name="l128">128</a></td><td><pre><span class="hunk">@@ -62,21 +62,19 @@</span> </span>class IRC(object):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l129" name="l129">129</a></td><td><pre> 			self.listen()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l130" name="l130">130</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l131" name="l131">131</a></td><td><pre> 	def create_socket(self):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l132" name="l132">132</a></td><td><pre><span class="deletion">-		family = socket.AF_INET6 if config.connection.ipv6 else socket.AF_INET</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l133" name="l133">133</a></td><td><pre><span class="deletion">-		self.sock = socket.socket(family, socket.SOCK_STREAM)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l134" name="l134">134</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">self.sock = socket.socket(AF_INET6) if config.connection.ipv6 else socket.socket()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l135" name="l135">135</a></td><td><pre> 		if config.connection.vhost:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l136" name="l136">136</a></td><td><pre> 			self.sock.bind((config.connection.vhost, 0))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l137" name="l137">137</a></td><td><pre> 		if config.connection.ssl:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l138" name="l138">138</a></td><td><pre> 			ctx = ssl.SSLContext()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l139" name="l139">139</a></td><td><pre> 			if config.cert.file:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l140" name="l140">140</a></td><td><pre><span class="deletion">-				ctx.load_cert_chain(config.cert.file, config.cert.key, config.cert.password)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l141" name="l141">141</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">ctx.load_cert_chain(config.cert.file, password=config.cert.password)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l142" name="l142">142</a></td><td><pre> 			if config.connection.ssl_verify:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l143" name="l143">143</a></td><td><pre><span class="deletion">-				ctx.verify_mode = ssl.CERT_REQUIRED</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l144" name="l144">144</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">ctx.check_hostname = True</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l145" name="l145">145</a></td><td><pre> 				ctx.load_default_certs()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l146" name="l146">146</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">self.sock = ctx.wrap_socket(self.sock, server_hostname=config.connection.server)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l147" name="l147">147</a></td><td><pre> 			else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l148" name="l148">148</a></td><td><pre><span class="deletion">-				ctx.check_hostname = False</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l149" name="l149">149</a></td><td><pre><span class="deletion">-				ctx.verify_mode = ssl.CERT_NONE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l150" name="l150">150</a></td><td><pre><span class="deletion">-			self.sock = ctx.wrap_socket(self.sock)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l151" name="l151">151</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">self.sock = ctx.wrap_socket(self.sock)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l152" name="l152">152</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l153" name="l153">153</a></td><td><pre> 	def listen(self):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l154" name="l154">154</a></td><td><pre> 		while True:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l155" name="l155">155</a></td><td><pre><span class="hunk">@@ -204,7 +202,7 @@</span> </span>class Events:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l156" name="l156">156</a></td><td><pre> 										Commands.sendmsg(chan, 'Cashed out {0} to your bank account! {1}'.format(color('${:,}'.format(int(amount)), constants.green), color('(current balance: ${:,})'.format(int(Bot.db['bank'][nick][0])), constants.grey)))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l157" name="l157">157</a></td><td><pre> 							elif len(args) == 1:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l158" name="l158">158</a></td><td><pre> 								if msg == '@irccex':</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l159" name="l159">159</a></td><td><pre><span class="deletion">-									Commands.sendmsg(chan, constants.bold + 'IRC Cryptocurrency Exchange (IRCCEX) - Developed by acidvegas in Python - https://acid.vegas/irccex')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l160" name="l160">160</a></td><td><pre><span class="insertion">+</span>									<span class="insertion">Commands.sendmsg(chan, constants.bold + 'IRC Cryptocurrency Exchange (IRCCEX) - Developed by acidvegas in Python - https://github.com/acidvegas/irccex')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l161" name="l161">161</a></td><td><pre> 								elif msg == '@stats':</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l162" name="l162">162</a></td><td><pre> 									bank_total = 0</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l163" name="l163">163</a></td><td><pre> 									global_data = CMC._global()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l164" name="l164">164</a></td><td><pre><span class="hunk">@@ -501,6 +499,7 @@</span> </span>class Events:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l165" name="l165">165</a></td><td><pre> class Loops:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l166" name="l166">166</a></td><td><pre> 	def start_loops():</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l167" name="l167">167</a></td><td><pre> 		threading.Thread(target=Loops.backup).start()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l168" name="l168">168</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">threading.Thread(target=Loops.double_fees).start()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l169" name="l169">169</a></td><td><pre> 		threading.Thread(target=Loops.maintenance).start()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l170" name="l170">170</a></td><td><pre> 		threading.Thread(target=Loops.remind).start()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l171" name="l171">171</a></td><td><pre> 		threading.Thread(target=Loops.reward).start()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l172" name="l172">172</a></td><td><pre><span class="hunk">@@ -510,11 +509,31 @@</span> </span>class Loops:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l173" name="l173">173</a></td><td><pre> 	def backup():</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l174" name="l174">174</a></td><td><pre> 		while True:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l175" name="l175">175</a></td><td><pre> 			time.sleep(3600) # 1H</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l176" name="l176">176</a></td><td><pre><span class="deletion">-			with open('data/db.pkl', 'wb') as db_file:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l177" name="l177">177</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">with open('db.pkl', 'wb') as db_file:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l178" name="l178">178</a></td><td><pre> 				pickle.dump(Bot.db, db_file, pickle.HIGHEST_PROTOCOL)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l179" name="l179">179</a></td><td><pre> 			Bot.last_backup = time.strftime('%I:%M')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l180" name="l180">180</a></td><td><pre> 			print('[+] - Database backed up!')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l181" name="l181">181</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l182" name="l182">182</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">def double_fees():</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l183" name="l183">183</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">original_fees = {'cashout':config.fees.cashout,'send':config.fees.send,'trade':config.fees.trade}</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l184" name="l184">184</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">while True:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l185" name="l185">185</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">try:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l186" name="l186">186</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">time.sleep(functions.random_int(604800,864000)) # 7D - 10D</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l187" name="l187">187</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">config.fees.cashout = original_fees['cashout']*2</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l188" name="l188">188</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">config.fees.send    = original_fees['send']*2</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l189" name="l189">189</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">config.fees.trade   = original_fees['trade']*2</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l190" name="l190">190</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">Commands.action(config.connection.channel, color('Double fees have been activated!', constants.red))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l191" name="l191">191</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">time.sleep(functions.random_int(86400, 259200)) # 1D - 3D</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l192" name="l192">192</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">config.fees.cashout = original_fees['cashout']/2</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l193" name="l193">193</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">config.fees.send    = original_fees['send']/2</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l194" name="l194">194</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">config.fees.trade   = original_fees['trade']/2</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l195" name="l195">195</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">Commands.notice(config.connection.channel, color('Double fees have been deactivated!', constants.red))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l196" name="l196">196</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">except Exception as ex:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l197" name="l197">197</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">config.fees.cashout = original_fees['cashout']</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l198" name="l198">198</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">config.fees.send    = original_fees['send']</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l199" name="l199">199</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">config.fees.trade   = original_fees['trade']</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l200" name="l200">200</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">print('[!] - Error occured in the double fees loop! (' + str(ex) + ')')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l201" name="l201">201</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l202" name="l202">202</a></td><td><pre> 	def maintenance():</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l203" name="l203">203</a></td><td><pre> 		while True:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l204" name="l204">204</a></td><td><pre> 			try:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l205" name="l205">205</a></td><td><pre><span class="hunk">@@ -596,5 +615,5 @@</span> </span>class Loops:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l206" name="l206">206</a></td><td><pre> 			finally:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l207" name="l207">207</a></td><td><pre> 				time.sleep(3600) # 1H</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l208" name="l208">208</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l209" name="l209">209</a></td><td><pre><span class="deletion">-CMC = CoinMarketCap()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l210" name="l210">210</a></td><td><pre> Bot = IRC()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l211" name="l211">211</a></td><td><pre><span class="insertion">+</span><span class="insertion">CMC = CoinMarketCap(config.CMC_API_KEY)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l212" name="l212">212</a></td><td><pre><span class="bold">diff --git a/irccex/data/cert/.gitignore b/irccex/data/cert/.gitignore</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l213" name="l213">213</a></td><td><pre><span class="bold">deleted file mode 100644</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l214" name="l214">214</a></td><td><pre><span class="bold">index 86d0cb2..0000000</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l215" name="l215">215</a></td><td><pre><span class="bold">--- a/irccex/data/cert/.gitignore</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l216" name="l216">216</a></td><td><pre><span class="bold">+++ /dev/null</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l217" name="l217">217</a></td><td><pre><span class="hunk">@@ -1,4 +0,0 @@</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l218" name="l218">218</a></td><td><pre><span class="deletion">-# Ignore everything in this directory</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l219" name="l219">219</a></td><td><pre><span class="deletion">-*</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l220" name="l220">220</a></td><td><pre><span class="deletion">-# Except this file</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l221" name="l221">221</a></td><td><pre><span class="deletion">-!.gitignore</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l222" name="l222">222</a></td><td><pre><span class="bold">diff --git a/irccex/data/dbx.py b/irccex/data/dbx.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l223" name="l223">223</a></td><td><pre><span class="bold">deleted file mode 100644</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l224" name="l224">224</a></td><td><pre><span class="bold">index 066067b..0000000</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l225" name="l225">225</a></td><td><pre><span class="bold">--- a/irccex/data/dbx.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l226" name="l226">226</a></td><td><pre><span class="bold">+++ /dev/null</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l227" name="l227">227</a></td><td><pre><span class="hunk">@@ -1,12 +0,0 @@</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l228" name="l228">228</a></td><td><pre><span class="deletion">-import pickle, coinmarketcap</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l229" name="l229">229</a></td><td><pre><span class="deletion">-CMC = coinmarketcap.CoinMarketCap()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l230" name="l230">230</a></td><td><pre><span class="deletion">-DB = pickle.load(open('db.pkl' 'rb'))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l231" name="l231">231</a></td><td><pre><span class="deletion">-wallets = dict()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l232" name="l232">232</a></td><td><pre><span class="deletion">-for nick in DB['wallet']:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l233" name="l233">233</a></td><td><pre><span class="deletion">-	total = 0</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l234" name="l234">234</a></td><td><pre><span class="deletion">-	for symbol in DB['wallet'][nick]:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l235" name="l235">235</a></td><td><pre><span class="deletion">-		total += DB['wallet'][nick][symbol] if symbol == 'USD' else CMC.get()[symbol]['price_usd']*DB['wallet'][nick][symbol]</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l236" name="l236">236</a></td><td><pre><span class="deletion">-	wallets[nick] = total</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l237" name="l237">237</a></td><td><pre><span class="deletion">-data = sorted(wallets, key=wallets.get, reverse=True)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l238" name="l238">238</a></td><td><pre><span class="deletion">-for item in data:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l239" name="l239">239</a></td><td><pre><span class="deletion">-	print('[{0:02}] {1} ${2:,}'.format(data.index(item)+1, item.ljust(9), wallets[item]))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l240" name="l240">240</a></td><td><pre><span class="bold">diff --git a/irccex/data/logs/.gitignore b/irccex/data/logs/.gitignore</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l241" name="l241">241</a></td><td><pre><span class="bold">deleted file mode 100644</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l242" name="l242">242</a></td><td><pre><span class="bold">index 86d0cb2..0000000</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l243" name="l243">243</a></td><td><pre><span class="bold">--- a/irccex/data/logs/.gitignore</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l244" name="l244">244</a></td><td><pre><span class="bold">+++ /dev/null</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l245" name="l245">245</a></td><td><pre><span class="hunk">@@ -1,4 +0,0 @@</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l246" name="l246">246</a></td><td><pre><span class="deletion">-# Ignore everything in this directory</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l247" name="l247">247</a></td><td><pre><span class="deletion">-*</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l248" name="l248">248</a></td><td><pre><span class="deletion">-# Except this file</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l249" name="l249">249</a></td><td><pre><span class="deletion">-!.gitignore</span></pre></td></tr>
</table>
<div id="footer">site generated by <a href="https://github.com/acidvegas/stagit" target="_blank">stagit</a> on <a href="#">05/03/20</a></div>
