<!doctype html>
<link rel="stylesheet" href="../../style.css">
<title>coinmarketcap :: 94ec88e</title>
<h1><a href="../index.html" title="Back to Repository">&larr;&#xFE0E;</a> coinmarketcap :: 94ec88e</h1>
<hr>
<table id="main" cellpadding="0" cellspacing="0">
<tr class="item"><td class="linenumber"><a href="#l1" name="l1">1</a></td><td><pre><span class="commit">commit 94ec88eaaefd3d071464e352179f23a0d54839b6</span><span class="commit"> (</span><span class="reference">HEAD -&gt; </span><span class="branch">master</span><span class="commit">, </span><span class="remote">origin/master</span><span class="commit">)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l2" name="l2">2</a></td><td><pre>Author: acidvegas &lt;acid.vegas@acid.vegas&gt;</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l3" name="l3">3</a></td><td><pre>Date:   Fri Mar 27 02:25:12 2020 -0400</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l4" name="l4">4</a></td><td><pre></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l5" name="l5">5</a></td><td><pre>    Initial commit</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l6" name="l6">6</a></td><td><pre>---</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l7" name="l7">7</a></td><td><pre> LICENSE          | 15 <span class="insertion">+++++++++++++++</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l8" name="l8">8</a></td><td><pre> README.md        | 48 <span class="insertion">++++++++++++++++++++++++++++++++++++++++++++++++</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l9" name="l9">9</a></td><td><pre> coinmarketcap.py | 55 <span class="insertion">+++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l10" name="l10">10</a></td><td><pre> 3 files changed, 118 insertions(+)</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l11" name="l11">11</a></td><td><pre></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l12" name="l12">12</a></td><td><pre><span class="bold">diff --git a/LICENSE b/LICENSE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l13" name="l13">13</a></td><td><pre><span class="bold">new file mode 100644</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l14" name="l14">14</a></td><td><pre><span class="bold">index 0000000..d521bd0</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l15" name="l15">15</a></td><td><pre><span class="bold">--- /dev/null</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l16" name="l16">16</a></td><td><pre><span class="bold">+++ b/LICENSE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l17" name="l17">17</a></td><td><pre><span class="hunk">@@ -0,0 +1,15 @@</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l18" name="l18">18</a></td><td><pre><span class="insertion">+</span><span class="insertion">ISC License</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l19" name="l19">19</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l20" name="l20">20</a></td><td><pre><span class="insertion">+</span><span class="insertion">Copyright (c) 2020, acidvegas &lt;acid.vegas@acid.vegas&gt;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l21" name="l21">21</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l22" name="l22">22</a></td><td><pre><span class="insertion">+</span><span class="insertion">Permission to use, copy, modify, and/or distribute this software for any</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l23" name="l23">23</a></td><td><pre><span class="insertion">+</span><span class="insertion">purpose with or without fee is hereby granted, provided that the above</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l24" name="l24">24</a></td><td><pre><span class="insertion">+</span><span class="insertion">copyright notice and this permission notice appear in all copies.</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l25" name="l25">25</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l26" name="l26">26</a></td><td><pre><span class="insertion">+</span><span class="insertion">THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l27" name="l27">27</a></td><td><pre><span class="insertion">+</span><span class="insertion">WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l28" name="l28">28</a></td><td><pre><span class="insertion">+</span><span class="insertion">MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l29" name="l29">29</a></td><td><pre><span class="insertion">+</span><span class="insertion">ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l30" name="l30">30</a></td><td><pre><span class="insertion">+</span><span class="insertion">WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l31" name="l31">31</a></td><td><pre><span class="insertion">+</span><span class="insertion">ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l32" name="l32">32</a></td><td><pre><span class="insertion">+</span><span class="insertion">OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l33" name="l33">33</a></td><td><pre><span class="bold">diff --git a/README.md b/README.md</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l34" name="l34">34</a></td><td><pre><span class="bold">new file mode 100644</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l35" name="l35">35</a></td><td><pre><span class="bold">index 0000000..2e85409</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l36" name="l36">36</a></td><td><pre><span class="bold">--- /dev/null</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l37" name="l37">37</a></td><td><pre><span class="bold">+++ b/README.md</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l38" name="l38">38</a></td><td><pre><span class="hunk">@@ -0,0 +1,48 @@</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l39" name="l39">39</a></td><td><pre><span class="insertion">+</span><span class="insertion"># coinmarketcap</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l40" name="l40">40</a></td><td><pre><span class="insertion">+</span><span class="insertion">&gt; A Python class for the API on [CoinMarketCap](https://coinmarketcap.com)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l41" name="l41">41</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l42" name="l42">42</a></td><td><pre><span class="insertion">+</span><span class="insertion">###### Requirements</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l43" name="l43">43</a></td><td><pre><span class="insertion">+</span><span class="insertion">* [Python](https://www.python.org/downloads/) *(**Note:** This script was developed to be used with the latest version of Python)*</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l44" name="l44">44</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l45" name="l45">45</a></td><td><pre><span class="insertion">+</span><span class="insertion">###### API Documentation</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l46" name="l46">46</a></td><td><pre><span class="insertion">+</span><span class="insertion">- [CoinMarketCap API Documentation](https://coinmarketcap.com/api/documentation/v1/)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l47" name="l47">47</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l48" name="l48">48</a></td><td><pre><span class="insertion">+</span><span class="insertion">###### Information</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l49" name="l49">49</a></td><td><pre><span class="insertion">+</span><span class="insertion">In order to use the CoinMarketCap API, you will need an API key which you can sign up for one [here](https://pro.coinmarketcap.com/signup/).</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l50" name="l50">50</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l51" name="l51">51</a></td><td><pre><span class="insertion">+</span><span class="insertion">Data from the API will be cached for 5 minutes at a time (that is how long it takes CoinMarketCap to refresh their data) this way you will not get rate limited.</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l52" name="l52">52</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l53" name="l53">53</a></td><td><pre><span class="insertion">+</span><span class="insertion">The class has only 2 main functions, one for global data and one for ticker data.</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l54" name="l54">54</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l55" name="l55">55</a></td><td><pre><span class="insertion">+</span><span class="insertion">###### Example</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l56" name="l56">56</a></td><td><pre><span class="insertion">+</span><span class="insertion">```python</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l57" name="l57">57</a></td><td><pre><span class="insertion">+</span><span class="insertion">from coinmarketcap import CoinMarketCap</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l58" name="l58">58</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l59" name="l59">59</a></td><td><pre><span class="insertion">+</span><span class="insertion">CMC  = CoinMarketCap('API_KEY_HERE')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l60" name="l60">60</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l61" name="l61">61</a></td><td><pre><span class="insertion">+</span><span class="insertion">global_data = CMC._global() # Global data example</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l62" name="l62">62</a></td><td><pre><span class="insertion">+</span><span class="insertion">print('Cryptocurrencies : ' + str(global_data['cryptocurrencies']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l63" name="l63">63</a></td><td><pre><span class="insertion">+</span><span class="insertion">print('Exchanges        : ' + str(global_data['exchanges']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l64" name="l64">64</a></td><td><pre><span class="insertion">+</span><span class="insertion">print('BTC Dominance    : ' + str(global_data['btc_dominance']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l65" name="l65">65</a></td><td><pre><span class="insertion">+</span><span class="insertion">print('ETH Dominance    : ' + str(global_data['eth_dominance']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l66" name="l66">66</a></td><td><pre><span class="insertion">+</span><span class="insertion">print('Market Cap       : ' + str(global_data['market_cap']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l67" name="l67">67</a></td><td><pre><span class="insertion">+</span><span class="insertion">print('Volume           : ' + str(global_data['volume']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l68" name="l68">68</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l69" name="l69">69</a></td><td><pre><span class="insertion">+</span><span class="insertion">ticker_data = CMC._ticker() # Ticker data example</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l70" name="l70">70</a></td><td><pre><span class="insertion">+</span><span class="insertion">for item in ticker_data:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l71" name="l71">71</a></td><td><pre><span class="insertion">+</span><span class="insertion">    print('Name        : ' + ticker_data[item]['name'])</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l72" name="l72">72</a></td><td><pre><span class="insertion">+</span><span class="insertion">    print('Symbol      : ' + ticker_data[item]['symbol'])</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l73" name="l73">73</a></td><td><pre><span class="insertion">+</span><span class="insertion">    print('Rank        : ' + str(ticker_data[item]['rank']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l74" name="l74">74</a></td><td><pre><span class="insertion">+</span><span class="insertion">    print('Price       : ' + str(ticker_data[item]['price']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l75" name="l75">75</a></td><td><pre><span class="insertion">+</span><span class="insertion">    print('1h  Percent : ' + str(ticker_data[item]['percent']['1h']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l76" name="l76">76</a></td><td><pre><span class="insertion">+</span><span class="insertion">    print('24h Percent : ' + str(ticker_data[item]['percent']['24h']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l77" name="l77">77</a></td><td><pre><span class="insertion">+</span><span class="insertion">    print('7d  Percent : ' + str(ticker_data[item]['percent']['7d']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l78" name="l78">78</a></td><td><pre><span class="insertion">+</span><span class="insertion">    print('Volume      : ' + str(ticker_data[item]['volume']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l79" name="l79">79</a></td><td><pre><span class="insertion">+</span><span class="insertion">    print('Market Cap  : ' + str(ticker_data[item]['market_cap']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l80" name="l80">80</a></td><td><pre><span class="insertion">+</span><span class="insertion">    input('') # Press enter to continue...</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l81" name="l81">81</a></td><td><pre><span class="insertion">+</span><span class="insertion">```</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l82" name="l82">82</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l83" name="l83">83</a></td><td><pre><span class="insertion">+</span><span class="insertion">###### Mirrors</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l84" name="l84">84</a></td><td><pre><span class="insertion">+</span><span class="insertion">- [acid.vegas](https://acid.vegas/coinmarketcap) *(main)*</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l85" name="l85">85</a></td><td><pre><span class="insertion">+</span><span class="insertion">- [GitHub](https://github.com/acidvegas/coinmarketcap)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l86" name="l86">86</a></td><td><pre><span class="insertion">+</span><span class="insertion">- [GitLab](https://gitlab.com/acidvegas/coinmarketcap)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l87" name="l87">87</a></td><td><pre><span class="bold">diff --git a/coinmarketcap.py b/coinmarketcap.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l88" name="l88">88</a></td><td><pre><span class="bold">new file mode 100644</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l89" name="l89">89</a></td><td><pre><span class="bold">index 0000000..3d2cfe3</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l90" name="l90">90</a></td><td><pre><span class="bold">--- /dev/null</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l91" name="l91">91</a></td><td><pre><span class="bold">+++ b/coinmarketcap.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l92" name="l92">92</a></td><td><pre><span class="hunk">@@ -0,0 +1,55 @@</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l93" name="l93">93</a></td><td><pre><span class="insertion">+</span><span class="insertion">#!/usr/bin/env python</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l94" name="l94">94</a></td><td><pre><span class="insertion">+</span><span class="insertion"># CoinMarketCap API Class - Developed by acidvegas in Python (https://acid.vegas/coinmarketcap)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l95" name="l95">95</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l96" name="l96">96</a></td><td><pre><span class="insertion">+</span><span class="insertion">import http.client</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l97" name="l97">97</a></td><td><pre><span class="insertion">+</span><span class="insertion">import json</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l98" name="l98">98</a></td><td><pre><span class="insertion">+</span><span class="insertion">import time</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l99" name="l99">99</a></td><td><pre><span class="insertion">+</span><span class="insertion">import zlib</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l100" name="l100">100</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l101" name="l101">101</a></td><td><pre><span class="insertion">+</span><span class="insertion">class CoinMarketCap(object):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l102" name="l102">102</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">def __init__(self, api_key):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l103" name="l103">103</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">self.api_key = api_key</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l104" name="l104">104</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">self.cache   = {'global':dict(), 'ticker':dict()}</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l105" name="l105">105</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">self.last    = {'global':0     , 'ticker':0     }</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l106" name="l106">106</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l107" name="l107">107</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">def _api(self, _endpoint):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l108" name="l108">108</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">conn = http.client.HTTPSConnection('pro-api.coinmarketcap.com', timeout=15)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l109" name="l109">109</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">conn.request('GET', '/v1/' + _endpoint, headers={'Accept':'application/json', 'Accept-Encoding':'deflate, gzip', 'X-CMC_PRO_API_KEY':self.api_key})</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l110" name="l110">110</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">response = zlib.decompress(conn.getresponse().read(), 16+zlib.MAX_WBITS).decode('utf-8').replace(': null', ': &quot;0&quot;')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l111" name="l111">111</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">conn.close()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l112" name="l112">112</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">return json.loads(response)['data']</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l113" name="l113">113</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l114" name="l114">114</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">def _global(self):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l115" name="l115">115</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">if time.time() - self.last['global'] &lt; 300:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l116" name="l116">116</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">return self.cache['global']</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l117" name="l117">117</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l118" name="l118">118</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">data = self._api('global-metrics/quotes/latest')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l119" name="l119">119</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">self.cache['global'] = {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l120" name="l120">120</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">'cryptocurrencies' : data['active_cryptocurrencies'],</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l121" name="l121">121</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">'exchanges'        : data['active_exchanges'],</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l122" name="l122">122</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">'btc_dominance'    : int(data['btc_dominance']),</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l123" name="l123">123</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">'eth_dominance'    : int(data['eth_dominance']),</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l124" name="l124">124</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">'market_cap'       : int(data['quote']['USD']['total_market_cap']),</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l125" name="l125">125</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">'volume'           : int(data['quote']['USD']['total_volume_24h'])</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l126" name="l126">126</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">}</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l127" name="l127">127</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">self.last['global'] = time.time()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l128" name="l128">128</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">return self.cache['global']</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l129" name="l129">129</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l130" name="l130">130</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">def _ticker(self):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l131" name="l131">131</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">if time.time() - self.last['ticker'] &lt; 300:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l132" name="l132">132</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">return self.cache['ticker']</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l133" name="l133">133</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l134" name="l134">134</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">data = self._api('cryptocurrency/listings/latest?limit=5000')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l135" name="l135">135</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">self.cache['ticker'] = dict()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l136" name="l136">136</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">for item in data:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l137" name="l137">137</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">self.cache['ticker'][item['symbol']] = {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l138" name="l138">138</a></td><td><pre><span class="insertion">+</span>					<span class="insertion">'name'       : item['name'],</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l139" name="l139">139</a></td><td><pre><span class="insertion">+</span>					<span class="insertion">'symbol'     : item['symbol'],</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l140" name="l140">140</a></td><td><pre><span class="insertion">+</span>					<span class="insertion">'rank'       : item['cmc_rank'],</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l141" name="l141">141</a></td><td><pre><span class="insertion">+</span>					<span class="insertion">'price'      : float(item['quote']['USD']['price']),</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l142" name="l142">142</a></td><td><pre><span class="insertion">+</span>					<span class="insertion">'percent'    : {'1h':float(item['quote']['USD']['percent_change_1h']), '24h':float(item['quote']['USD']['percent_change_24h']), '7d':float(item['quote']['USD']['percent_change_7d'])},</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l143" name="l143">143</a></td><td><pre><span class="insertion">+</span>					<span class="insertion">'volume'     : int(float(item['quote']['USD']['volume_24h'])),</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l144" name="l144">144</a></td><td><pre><span class="insertion">+</span>					<span class="insertion">'market_cap' : int(float(item['quote']['USD']['market_cap']))</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l145" name="l145">145</a></td><td><pre><span class="insertion">+</span>				<span class="insertion">}</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l146" name="l146">146</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">self.last['ticker'] = time.time()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l147" name="l147">147</a></td><td><pre><span class="insertion">+</span>			<span class="insertion">return self.cache['ticker']</span></pre></td></tr>
</table></pre>
