<!doctype html>
<link rel="stylesheet" href="../../style.css">
<title>tools :: d419740</title>
<h1><a href="../index.html" title="Back to Repository">&larr;&#xFE0E;</a> tools :: d419740</h1>
<hr>
<table id="main" cellpadding="0" cellspacing="0">
<tr class="item"><td class="linenumber"><a href="#l1" name="l1">1</a></td><td><pre><span class="commit">commit d419740c326eb902d275bdefbe6e939021cd77c4</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l2" name="l2">2</a></td><td><pre>Author: acidvegas &lt;acid.vegas@acid.vegas&gt;</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l3" name="l3">3</a></td><td><pre>Date:   Mon Aug 12 23:01:23 2019 -0400</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l4" name="l4">4</a></td><td><pre></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l5" name="l5">5</a></td><td><pre>    updated</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l6" name="l6">6</a></td><td><pre>---</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l7" name="l7">7</a></td><td><pre> deploy-anope      |  6 <span class="insertion">++</span><span class="deletion">----</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l8" name="l8">8</a></td><td><pre> deploy-nginx      |  9 <span class="insertion">+++++</span><span class="deletion">----</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l9" name="l9">9</a></td><td><pre> deploy-unrealircd | 37 <span class="insertion">+++++++++++++++++++++++++</span><span class="deletion">-----------</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l10" name="l10">10</a></td><td><pre> monitor           |  8 <span class="insertion">++++++++</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l11" name="l11">11</a></td><td><pre> updates.py        | 56 <span class="deletion">-------------------------------------------------------</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l12" name="l12">12</a></td><td><pre> 5 files changed, 41 insertions(+), 75 deletions(-)</pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l13" name="l13">13</a></td><td><pre></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l14" name="l14">14</a></td><td><pre><span class="bold">diff --git a/deploy-anope b/deploy-anope</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l15" name="l15">15</a></td><td><pre><span class="bold">index 7c1e606..beffeb2 100755</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l16" name="l16">16</a></td><td><pre><span class="bold">--- a/deploy-anope</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l17" name="l17">17</a></td><td><pre><span class="bold">+++ b/deploy-anope</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l18" name="l18">18</a></td><td><pre><span class="hunk">@@ -7,8 +7,7 @@</span> </span>SOURCE=$HOME/services.source</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l19" name="l19">19</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l20" name="l20">20</a></td><td><pre> setup() {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l21" name="l21">21</a></td><td><pre> 	git clone --depth 1 https://github.com/supernets/anope.git $SOURCE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l22" name="l22">22</a></td><td><pre><span class="deletion">-	cd $SOURCE &amp;&amp; $SOURCE/Config -nointro -quick &amp;&amp; make &amp;&amp; make install</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l23" name="l23">23</a></td><td><pre><span class="deletion">-	cd $HOME &amp;&amp; rm -rf $SOURCE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l24" name="l24">24</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">cd $SOURCE &amp;&amp; $SOURCE/Config -nointro -quick &amp;&amp; make &amp;&amp; make install &amp;&amp; cd $HOME &amp;&amp; rm -rf $SOURCE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l25" name="l25">25</a></td><td><pre> }</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l26" name="l26">26</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l27" name="l27">27</a></td><td><pre> deploy() {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l28" name="l28">28</a></td><td><pre><span class="hunk">@@ -17,8 +16,7 @@</span> </span>deploy() {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l29" name="l29">29</a></td><td><pre> }</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l30" name="l30">30</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l31" name="l31">31</a></td><td><pre> update() {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l32" name="l32">32</a></td><td><pre><span class="deletion">-	#todo: check &amp; kill abduco watchdog process</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l33" name="l33">33</a></td><td><pre><span class="deletion">-	[ ! -z $(screen -ls | grep ircdwatchdog) ] &amp;&amp; screen -S ircdwatchdog -X quit</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l34" name="l34">34</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">[ ! -z $(screen -ls | grep ircdwatchdog) ] &amp;&amp; screen -S ircdwatchdog -X quit #todo: check &amp; kill abduco watchdog process</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l35" name="l35">35</a></td><td><pre> 	mkdir $BACKUP</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l36" name="l36">36</a></td><td><pre> 	cp $NAOPE/conf/services.conf $BACKUP &amp;&amp; cp $ANOPE/data/anope.db $BACKUP</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l37" name="l37">37</a></td><td><pre> 	pkill -9 services</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l38" name="l38">38</a></td><td><pre><span class="bold">diff --git a/deploy-nginx b/deploy-nginx</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l39" name="l39">39</a></td><td><pre><span class="bold">index 26b437d..6f7c68b 100755</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l40" name="l40">40</a></td><td><pre><span class="bold">--- a/deploy-nginx</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l41" name="l41">41</a></td><td><pre><span class="bold">+++ b/deploy-nginx</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l42" name="l42">42</a></td><td><pre><span class="hunk">@@ -1,7 +1,8 @@</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l43" name="l43">43</a></td><td><pre> #!/bin/sh</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l44" name="l44">44</a></td><td><pre> set -xev</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l45" name="l45">45</a></td><td><pre><span class="deletion">-</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l46" name="l46">46</a></td><td><pre> pacman -S certbot nginx-mainline</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l47" name="l47">47</a></td><td><pre><span class="insertion">+</span><span class="insertion">htpasswd -c /home/irc/public_html/conf/.htpasswd restricted</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l48" name="l48">48</a></td><td><pre><span class="insertion">+</span><span class="insertion">certbot --nginx -d hub.supernets.org</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l49" name="l49">49</a></td><td><pre> echo &quot;worker_processes auto;&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l50" name="l50">50</a></td><td><pre> echo &quot;worker_cpu_affinity auto;&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l51" name="l51">51</a></td><td><pre> echo &quot;error_log logs/error.log;&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l52" name="l52">52</a></td><td><pre><span class="hunk">@@ -15,10 +16,10 @@</span> </span>echo -e &quot;\taccess_log off;&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l53" name="l53">53</a></td><td><pre> echo -e &quot;\tsendfile on;&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l54" name="l54">54</a></td><td><pre> echo -e &quot;\tserver_tokens off;&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l55" name="l55">55</a></td><td><pre> echo -e &quot;\tserver {&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l56" name="l56">56</a></td><td><pre><span class="deletion">-echo -e &quot;\t\tlisten PORT;&quot;      #note: change port</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l57" name="l57">57</a></td><td><pre><span class="deletion">-echo -e &quot;\t\tlisten [::]:PORT;&quot; #note: change port</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l58" name="l58">58</a></td><td><pre><span class="insertion">+</span><span class="insertion">echo -e &quot;\t\tlisten PORT ssl;&quot;      #note: change port</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l59" name="l59">59</a></td><td><pre><span class="insertion">+</span><span class="insertion">echo -e &quot;\t\tlisten [::]:PORT ssl;&quot; #note: change port</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l60" name="l60">60</a></td><td><pre> echo -e &quot;\t\troot /home/supernets/www;&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l61" name="l61">61</a></td><td><pre><span class="deletion">-echo -e &quot;\t\tserver_name localhost;&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l62" name="l62">62</a></td><td><pre><span class="insertion">+</span><span class="insertion">echo -e &quot;\t\tserver_name hub.supernets.org;&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l63" name="l63">63</a></td><td><pre> echo -e &quot;\t\tcharset UTF-8;&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l64" name="l64">64</a></td><td><pre> echo -e &quot;\t\t#satisfy all;&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l65" name="l65">65</a></td><td><pre> echo -e &quot;\t\tallow 1.2.3.4; # Link 1&quot; #note: add all ipv4/ipv6 links</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l66" name="l66">66</a></td><td><pre><span class="bold">diff --git a/deploy-unrealircd b/deploy-unrealircd</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l67" name="l67">67</a></td><td><pre><span class="bold">index 271cf1d..599bd52 100755</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l68" name="l68">68</a></td><td><pre><span class="bold">--- a/deploy-unrealircd</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l69" name="l69">69</a></td><td><pre><span class="bold">+++ b/deploy-unrealircd</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l70" name="l70">70</a></td><td><pre><span class="hunk">@@ -1,37 +1,52 @@</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l71" name="l71">71</a></td><td><pre> #!/bin/sh</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l72" name="l72">72</a></td><td><pre> set -xev</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l73" name="l73">73</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l74" name="l74">74</a></td><td><pre><span class="deletion">-BACKUP=$HOME/unrealircd.backup</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l75" name="l75">75</a></td><td><pre><span class="deletion">-SOURCE=$HOME/unrealircd.source</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l76" name="l76">76</a></td><td><pre> UNREAL=$HOME/unrealircd</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l77" name="l77">77</a></td><td><pre><span class="insertion">+</span><span class="insertion">BACKUP=$UNREAL.backup</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l78" name="l78">78</a></td><td><pre><span class="insertion">+</span><span class="insertion">SOURCE=$UNREAL.source</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l79" name="l79">79</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l80" name="l80">80</a></td><td><pre><span class="deletion">-setup() {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l81" name="l81">81</a></td><td><pre><span class="deletion">-	git clone --depth 1 https://github.com/supernets/unrealircd.git $SOURCE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l82" name="l82">82</a></td><td><pre><span class="deletion">-	cd $SOURCE &amp;&amp; echo -e &quot;\n&quot; | ./Config -nointro &amp;&amp; make &amp;&amp; make install</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l83" name="l83">83</a></td><td><pre><span class="deletion">-	cd $HOME &amp;&amp; rm -rf $SOURCE &amp;&amp; rm $UNREAL/conf/*.conf</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l84" name="l84">84</a></td><td><pre><span class="insertion">+</span><span class="insertion">get_latest() {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l85" name="l85">85</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">curl -s https://www.unrealircd.org/downloads/list.json | sed -e 's/[{}]/''/g' | awk -v RS=',&quot;' -F: '/^version/ {print $2}' | sed 's/\(^&quot;\|&quot;$\)//g'</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l86" name="l86">86</a></td><td><pre><span class="insertion">+</span><span class="insertion">}</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l87" name="l87">87</a></td><td><pre><span class="insertion">+</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l88" name="l88">88</a></td><td><pre><span class="insertion">+</span><span class="insertion">update_source() {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l89" name="l89">89</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">wget -O $SOURCE.tar.gz https://www.unrealircd.org/downloads/unrealircd-latest.tar.gz</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l90" name="l90">90</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">tar -xvf $SOURCE.tar.gz --one-top-level --strip-components=1</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l91" name="l91">91</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">rm $SOURCE.tar.gz</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l92" name="l92">92</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">sed -i 's;//#undef FAKELAG_CONFIGURABLE;#define FAKELAG_CONFIGURABLE;g' $SOURCE/include/config.h</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l93" name="l93">93</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">sed -i 's_\t\t\tsendnotice(acptr, &quot;*** You were forced to join %s&quot;, jbuf);_\t\t\t//sendnotice(acptr, &quot;*** You were forced to join %s&quot;, jbuf);_g' $SOURCE/src/modules/m_sapart.c</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l94" name="l94">94</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">rm -r $SOURCE/doc/conf/aliases $SOURCE/doc/conf/examples $SOURCE/doc/conf/help</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l95" name="l95">95</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">rm -r $SOURCE/doc/conf/*.conf</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l96" name="l96">96</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">cp $HOME/dev/git/supernets/unrealircd/doc/conf/*.conf $SOURCE/doc/conf/</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l97" name="l97">97</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">cp $HOME/dev/git/supernets/unrealircd/src/ssl.cnf $SOURCE/src/ssl.cnf</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l98" name="l98">98</a></td><td><pre> }</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l99" name="l99">99</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l100" name="l100">100</a></td><td><pre> deploy() {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l101" name="l101">101</a></td><td><pre><span class="deletion">-	setup</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l102" name="l102">102</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">git clone --depth 1 https://github.com/supernets/unrealircd.git $SOURCE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l103" name="l103">103</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">cd $SOURCE &amp;&amp; echo -e &quot;\n&quot; | ./Config -nointro &amp;&amp; make &amp;&amp; make install &amp;&amp; cd $HOME &amp;&amp; rm -rf $SOURCE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l104" name="l104">104</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">rm $UNREAL/conf/*.conf</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l105" name="l105">105</a></td><td><pre> 	read -p &quot;Link Name: &quot; NAME</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l106" name="l106">106</a></td><td><pre> 	SID=$(cat /dev/urandom | tr -dc '0-9' | fold -w 256 | head -n 1 | head --bytes 1)$(cat /dev/urandom | tr -dc 'A-Z0-9' | fold -w 2 | head -n 1)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l107" name="l107">107</a></td><td><pre><span class="deletion">-	echo &quot;[NOTE] - Your remote include should be in https://USERNAME:PASSWORD@HOSTNAME:PORT format&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l108" name="l108">108</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">echo &quot;[NOTE] - Your remote include should be in http(s)://USERNAME:PASSWORD@HOSTNAME:PORT format&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l109" name="l109">109</a></td><td><pre> 	read -p &quot;Remote Include: &quot; REMOTE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l110" name="l110">110</a></td><td><pre> 	for item in aliases badwords except help ircd modules opers spamfilter; do echo $REMOTE/$item.conf &gt;&gt; $UNREAL/conf/unrealircd.conf; done</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l111" name="l111">111</a></td><td><pre> 	echo &quot;me { name \&quot;$NAME.supernets.org\&quot;; info \&quot;SuperNETs IRC Network\&quot;; sid $SID; }&quot; &gt;&gt; $UNREAL/conf/unrealircd.conf</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l112" name="l112">112</a></td><td><pre> 	SPKI=$($UNREAL/unrealircd spkifp | sed -n 5p)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l113" name="l113">113</a></td><td><pre> 	echo -e &quot;\nAdd the following line into the hub\'s links.conf file for this link:\n$SPKI&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l114" name="l114">114</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">$UNREAL/unrealircd start &amp;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l115" name="l115">115</a></td><td><pre> }</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l116" name="l116">116</a></td><td><pre> </span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l117" name="l117">117</a></td><td><pre> update() {</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l118" name="l118">118</a></td><td><pre><span class="deletion">-	#todo: check &amp; kill abduco watchdog process</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l119" name="l119">119</a></td><td><pre> 	[ ! -z $(screen -ls | grep ircdwatchdog) ] &amp;&amp; screen -S ircdwatchdog -X quit</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l120" name="l120">120</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">[ ! -z $(abduco     | grep ircdwatchdog) ] &amp;&amp; pkill -9 $(abduco | grep ircdwatchdog | awk '{print $4}')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l121" name="l121">121</a></td><td><pre> 	mkdir $BACKUP</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l122" name="l122">122</a></td><td><pre> 	cp $UNREAL/conf/unrealircd.conf $BACKUP &amp;&amp; cp $UNREAL/conf/ssl/server.*.pem $BACKUP</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l123" name="l123">123</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">#cp $UNREAL/conf/links.conf $BACKUP &amp;&amp; cp $UNREAL/conf/modules.conf $BACKUP &amp;&amp; cp $UNREAL/conf/opers.conf $BACKUP</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l124" name="l124">124</a></td><td><pre> 	$UNREAL/unrealircd stop</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l125" name="l125">125</a></td><td><pre> 	rm -rf $UNREAL</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l126" name="l126">126</a></td><td><pre><span class="deletion">-	setup</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l127" name="l127">127</a></td><td><pre><span class="deletion">-	mv $BACKUP/unrealircd.conf $UNREAL/conf/ &amp;&amp; mv $BACKUP/server.*.pem $UNREAL/conf/ssl</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l128" name="l128">128</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">git clone --depth 1 https://github.com/supernets/unrealircd.git $SOURCE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l129" name="l129">129</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">cd $SOURCE &amp;&amp; echo -e &quot;\n&quot; | ./Config -nointro &amp;&amp; make &amp;&amp; make install &amp;&amp; cd $HOME &amp;&amp; rm -rf $SOURCE</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l130" name="l130">130</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">mv $BACKUP/*.conf $UNREAL/conf/ &amp;&amp; mv $BACKUP/server.*.pem $UNREAL/conf/ssl</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l131" name="l131">131</a></td><td><pre> 	rm -r $BACKUP</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l132" name="l132">132</a></td><td><pre> 	$UNREAL/unrealircd start</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l133" name="l133">133</a></td><td><pre> 	watchdog</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l134" name="l134">134</a></td><td><pre><span class="bold">diff --git a/monitor b/monitor</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l135" name="l135">135</a></td><td><pre><span class="bold">new file mode 100755</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l136" name="l136">136</a></td><td><pre><span class="bold">index 0000000..b248485</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l137" name="l137">137</a></td><td><pre><span class="bold">--- /dev/null</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l138" name="l138">138</a></td><td><pre><span class="bold">+++ b/monitor</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l139" name="l139">139</a></td><td><pre><span class="hunk">@@ -0,0 +1,8 @@</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l140" name="l140">140</a></td><td><pre><span class="insertion">+</span><span class="insertion">#!/bin/sh</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l141" name="l141">141</a></td><td><pre><span class="insertion">+</span><span class="insertion">while true; do</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l142" name="l142">142</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">for i in $(dig irc.supernets.org A irc.supernets.org AAAA +short); do</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l143" name="l143">143</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">ping -c 1 $i &amp;&gt; /dev/null</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l144" name="l144">144</a></td><td><pre><span class="insertion">+</span>		<span class="insertion">[ $? -ne 0 ] &amp;&amp; echo &quot;`date`: ping failed! ($i)&quot; #&amp;&amp; notify-send &quot;`date`: ping failed! ($i)&quot;</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l145" name="l145">145</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">done</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l146" name="l146">146</a></td><td><pre><span class="insertion">+</span>	<span class="insertion">sleep 3600</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l147" name="l147">147</a></td><td><pre><span class="insertion">+</span><span class="insertion">done</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l148" name="l148">148</a></td><td><pre><span class="bold">diff --git a/updates.py b/updates.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l149" name="l149">149</a></td><td><pre><span class="bold">deleted file mode 100644</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l150" name="l150">150</a></td><td><pre><span class="bold">index d12ec05..0000000</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l151" name="l151">151</a></td><td><pre><span class="bold">--- a/updates.py</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l152" name="l152">152</a></td><td><pre><span class="bold">+++ /dev/null</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l153" name="l153">153</a></td><td><pre><span class="hunk">@@ -1,56 +0,0 @@</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l154" name="l154">154</a></td><td><pre><span class="deletion">-#!/usr/bin/env python</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l155" name="l155">155</a></td><td><pre><span class="deletion">-import re, urllib.request</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l156" name="l156">156</a></td><td><pre><span class="deletion">-</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l157" name="l157">157</a></td><td><pre><span class="deletion">-anope_version      = '2.0.6'</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l158" name="l158">158</a></td><td><pre><span class="deletion">-bootstrap_version  = '4.0.0'</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l159" name="l159">159</a></td><td><pre><span class="deletion">-jquery_version     = '3.3.1'</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l160" name="l160">160</a></td><td><pre><span class="deletion">-unrealircd_version = '4.0.17'</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l161" name="l161">161</a></td><td><pre><span class="deletion">-</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l162" name="l162">162</a></td><td><pre><span class="deletion">-def between(source, start, stop):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l163" name="l163">163</a></td><td><pre><span class="deletion">-	data = re.compile(start + '(.*?)' + stop, re.IGNORECASE|re.MULTILINE).search(source)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l164" name="l164">164</a></td><td><pre><span class="deletion">-	return data.group(1) if data else False</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l165" name="l165">165</a></td><td><pre><span class="deletion">-</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l166" name="l166">166</a></td><td><pre><span class="deletion">-def get_source(url):</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l167" name="l167">167</a></td><td><pre><span class="deletion">-	req = urllib.request.Request(url)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l168" name="l168">168</a></td><td><pre><span class="deletion">-	req.add_header('User-Agent', 'DickServ/1.0')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l169" name="l169">169</a></td><td><pre><span class="deletion">-	source = urllib.request.urlopen(req, timeout=10)</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l170" name="l170">170</a></td><td><pre><span class="deletion">-	charset = source.headers.get_content_charset()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l171" name="l171">171</a></td><td><pre><span class="deletion">-	return source.read().decode(charset) if charset else source.read().decode()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l172" name="l172">172</a></td><td><pre><span class="deletion">-</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l173" name="l173">173</a></td><td><pre><span class="deletion">-def update_anope()      : return between(get_source('http://www.anope.org/'), '&lt;span&gt;Latest Stable Release:&lt;/span&gt; Anope ', '\n')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l174" name="l174">174</a></td><td><pre><span class="deletion">-def update_bootstrap()  : return between(get_source('http://getbootstrap.com/'), '&lt;p&gt;Currently v', '. Code licensed')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l175" name="l175">175</a></td><td><pre><span class="deletion">-def update_jquery()     : return between(get_source('http://jquery.com/'), '&lt;span&gt;v', '&lt;/span&gt;')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l176" name="l176">176</a></td><td><pre><span class="deletion">-def update_unrealircd() : return between(get_source('http://www.unrealircd.org/docs/FAQ'), '&lt;p&gt;The latest &lt;b&gt;Stable&lt;/b&gt; version is &lt;b&gt;', '&lt;/b&gt;')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l177" name="l177">177</a></td><td><pre><span class="deletion">-</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l178" name="l178">178</a></td><td><pre><span class="deletion">-latest_anope = update_anope()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l179" name="l179">179</a></td><td><pre><span class="deletion">-if latest_anope:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l180" name="l180">180</a></td><td><pre><span class="deletion">-	if latest_anope != anope_version:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l181" name="l181">181</a></td><td><pre><span class="deletion">-		print(f'Anope version {latest_anope} has been released!')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l182" name="l182">182</a></td><td><pre><span class="deletion">-	else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l183" name="l183">183</a></td><td><pre><span class="deletion">-		print('Anope is up to date.')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l184" name="l184">184</a></td><td><pre><span class="deletion">-else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l185" name="l185">185</a></td><td><pre><span class="deletion">-	print('[!] - Can not retrieve latest Anope version.')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l186" name="l186">186</a></td><td><pre><span class="deletion">-latest_bootstrap = update_bootstrap()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l187" name="l187">187</a></td><td><pre><span class="deletion">-if latest_bootstrap:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l188" name="l188">188</a></td><td><pre><span class="deletion">-	if latest_bootstrap != bootstrap_version:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l189" name="l189">189</a></td><td><pre><span class="deletion">-		print(f'Bootstrap version {latest_bootstrap} has been released!')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l190" name="l190">190</a></td><td><pre><span class="deletion">-	else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l191" name="l191">191</a></td><td><pre><span class="deletion">-		print('Bootstrap is up to date.')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l192" name="l192">192</a></td><td><pre><span class="deletion">-else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l193" name="l193">193</a></td><td><pre><span class="deletion">-	print('[!] - Can not retrieve latest Bootstrap version.')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l194" name="l194">194</a></td><td><pre><span class="deletion">-latest_jquery = update_jquery()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l195" name="l195">195</a></td><td><pre><span class="deletion">-if latest_jquery:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l196" name="l196">196</a></td><td><pre><span class="deletion">-	if latest_jquery != jquery_version:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l197" name="l197">197</a></td><td><pre><span class="deletion">-		print(f'jQuery version {latest_jquery} has been released!')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l198" name="l198">198</a></td><td><pre><span class="deletion">-	else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l199" name="l199">199</a></td><td><pre><span class="deletion">-		print('jQuery is up to date.')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l200" name="l200">200</a></td><td><pre><span class="deletion">-else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l201" name="l201">201</a></td><td><pre><span class="deletion">-	print('[!] - Can not retrieve latest jQuery version.')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l202" name="l202">202</a></td><td><pre><span class="deletion">-latest_unrealircd = update_unrealircd()</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l203" name="l203">203</a></td><td><pre><span class="deletion">-if latest_unrealircd:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l204" name="l204">204</a></td><td><pre><span class="deletion">-	if latest_unrealircd != unrealircd_version:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l205" name="l205">205</a></td><td><pre><span class="deletion">-		print(f'UnrealIRCd version {latest_unrealircd} has been released!')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l206" name="l206">206</a></td><td><pre><span class="deletion">-	else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l207" name="l207">207</a></td><td><pre><span class="deletion">-		print('UnrealIRCd is up to date.')</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l208" name="l208">208</a></td><td><pre><span class="deletion">-else:</span></pre></td></tr>
<tr class="item"><td class="linenumber"><a href="#l209" name="l209">209</a></td><td><pre><span class="deletion">-	print('[!] - Can not retrieve latest UnrealIRCd version.')</span></pre></td></tr>
</table>
<div id="footer">site generated by <a href="https://github.com/acidvegas/stagit" target="_blank">stagit</a> on <a href="#">05/03/20</a></div>
